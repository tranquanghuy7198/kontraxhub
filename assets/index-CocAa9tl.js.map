{"version":3,"file":"index-CocAa9tl.js","sources":["../../src/pages/trending-contracts/index.tsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport Header from \"@components/header\";\nimport {\n  ContractAddress,\n  ContractTemplate,\n  DeployedContract,\n  NetworkCluster,\n} from \"@utils/constants\";\nimport ContractCard from \"@components/contract-card\";\nimport { capitalize } from \"@utils/utils\";\nimport { XBlock, XMasonry } from \"react-xmasonry\";\nimport { useBlockchains } from \"@hooks/blockchain\";\nimport { useFetchPopularContracts } from \"@hooks/contract\";\nimport MainLayout from \"@components/main-layout\";\nimport { useSearchParams } from \"react-router-dom\";\nimport { buildContractHash, CONTRACT_PARAM } from \"@utils/share\";\nimport ContractInteraction from \"@components/contract-interaction\";\nimport useNotification from \"antd/es/notification/useNotification\";\n\nconst TrendingContracts: React.FC = () => {\n  const [notification, contextHolder] = useNotification();\n  const { blockchains } = useBlockchains();\n  const { trendingContracts, trendingLoading } = useFetchPopularContracts();\n  const [displayedContracts, setDisplayedContracts] = useState<\n    DeployedContract[]\n  >([]);\n  const [selectedClusters, setSelectedClusters] = useState<string[]>([]);\n  const [searchedName, setSearchedName] = useState<string>();\n  const [selectedAddress, setSelectedAddress] = useState<{\n    template?: ContractTemplate;\n    address?: ContractAddress;\n    open: boolean;\n  }>({ open: false });\n  const [params] = useSearchParams();\n\n  useEffect(() => {\n    const contractHash = params.get(CONTRACT_PARAM);\n    for (const contract of trendingContracts)\n      for (const address of contract.addresses)\n        if (\n          buildContractHash(\n            contract.template.id,\n            address.blockchainId,\n            address.address,\n            blockchains.find((chain) => chain.id === address.blockchainId)\n              ?.networkCluster\n          ) === contractHash\n        ) {\n          setSelectedAddress({\n            template: contract.template,\n            address,\n            open: true,\n          });\n          break;\n        }\n  }, [params, trendingContracts, blockchains]);\n\n  useEffect(() => {\n    setDisplayedContracts(\n      trendingContracts.filter((contract) => {\n        if (\n          searchedName &&\n          !contract.template.name\n            .toLowerCase()\n            .includes(searchedName.toLowerCase())\n        )\n          return false;\n        for (const selectedNetworkCluster of selectedClusters)\n          if (\n            !blockchains\n              .filter((chain) =>\n                contract.addresses\n                  .map((address) => address.blockchainId)\n                  .includes(chain.id)\n              )\n              .map((chain) => chain.networkCluster.toString())\n              .includes(selectedNetworkCluster)\n          )\n            return false;\n        return true;\n      })\n    );\n  }, [trendingContracts, blockchains, selectedClusters, searchedName]);\n\n  const interactContract = (\n    template: ContractTemplate,\n    address: ContractAddress\n  ) => {\n    const contractChain = blockchains.find(\n      (chain) => chain.id === address.blockchainId\n    );\n    if (contractChain) setSelectedAddress({ template, address, open: true });\n    else\n      notification.error({\n        message: \"Blockchain not found\",\n        description:\n          \"This blockchain is not supported anymore, or your customized blockchain was deleted.\",\n      });\n  };\n\n  return (\n    <MainLayout loading={trendingLoading}>\n      {contextHolder}\n      <Header\n        header=\"Popular Contracts\"\n        options={Object.values(NetworkCluster).map((cluster) => ({\n          value: cluster.toString(),\n          label: capitalize(cluster.toString()),\n        }))}\n        onSelected={setSelectedClusters}\n        onSearched={setSearchedName}\n        defaultSelectAll={false}\n      />\n      <div className=\"masonry-container\">\n        <XMasonry center={false} targetBlockWidth={300}>\n          {displayedContracts.map((contract) => (\n            <XBlock key={contract.template.id}>\n              <ContractCard contract={contract} onInteract={interactContract} />\n            </XBlock>\n          ))}\n        </XMasonry>\n      </div>\n      <ContractInteraction\n        open={selectedAddress.open}\n        template={selectedAddress.template}\n        address={selectedAddress.address}\n        blockchain={blockchains.find(\n          (chain) => chain.id === selectedAddress.address?.blockchainId\n        )}\n        onClose={() => setSelectedAddress({ ...selectedAddress, open: false })}\n      />\n    </MainLayout>\n  );\n};\n\nexport default TrendingContracts;\n"],"names":["TrendingContracts","notification","contextHolder","useNotification","blockchains","useBlockchains","trendingContracts","trendingLoading","useFetchPopularContracts","displayedContracts","setDisplayedContracts","useState","selectedClusters","setSelectedClusters","searchedName","setSearchedName","selectedAddress","setSelectedAddress","params","useSearchParams","useEffect","contractHash","CONTRACT_PARAM","contract","address","buildContractHash","chain","selectedNetworkCluster","interactContract","template","jsxs","MainLayout","jsx","Header","NetworkCluster","cluster","capitalize","XMasonry","XBlock","ContractCard","ContractInteraction"],"mappings":"wOAmBA,MAAMA,EAA8B,IAAM,CACxC,KAAM,CAACC,EAAcC,CAAa,EAAIC,EAAA,EAChC,CAAE,YAAAC,CAAA,EAAgBC,EAAA,EAClB,CAAE,kBAAAC,EAAmB,gBAAAC,CAAA,EAAoBC,EAAA,EACzC,CAACC,EAAoBC,CAAqB,EAAIC,EAAAA,SAElD,CAAA,CAAE,EACE,CAACC,EAAkBC,CAAmB,EAAIF,EAAAA,SAAmB,CAAA,CAAE,EAC/D,CAACG,EAAcC,CAAe,EAAIJ,WAAA,EAClC,CAACK,EAAiBC,CAAkB,EAAIN,EAAAA,SAI3C,CAAE,KAAM,GAAO,EACZ,CAACO,CAAM,EAAIC,EAAA,EAEjBC,EAAAA,UAAU,IAAM,CACd,MAAMC,EAAeH,EAAO,IAAII,CAAc,EAC9C,UAAWC,KAAYjB,EACrB,UAAWkB,KAAWD,EAAS,UAC7B,GACEE,EACEF,EAAS,SAAS,GAClBC,EAAQ,aACRA,EAAQ,QACRpB,EAAY,KAAMsB,GAAUA,EAAM,KAAOF,EAAQ,YAAY,GACzD,cAAA,IACAH,EACN,CACAJ,EAAmB,CACjB,SAAUM,EAAS,SACnB,QAAAC,EACA,KAAM,EAAA,CACP,EACD,KACF,CACN,EAAG,CAACN,EAAQZ,EAAmBF,CAAW,CAAC,EAE3CgB,EAAAA,UAAU,IAAM,CACdV,EACEJ,EAAkB,OAAQiB,GAAa,CACrC,GACET,GACA,CAACS,EAAS,SAAS,KAChB,cACA,SAAST,EAAa,aAAa,EAEtC,MAAO,GACT,UAAWa,KAA0Bf,EACnC,GACE,CAACR,EACE,OAAQsB,GACPH,EAAS,UACN,IAAKC,GAAYA,EAAQ,YAAY,EACrC,SAASE,EAAM,EAAE,CAAA,EAErB,IAAKA,GAAUA,EAAM,eAAe,SAAA,CAAU,EAC9C,SAASC,CAAsB,EAElC,MAAO,GACX,MAAO,EACT,CAAC,CAAA,CAEL,EAAG,CAACrB,EAAmBF,EAAaQ,EAAkBE,CAAY,CAAC,EAEnE,MAAMc,EAAmB,CACvBC,EACAL,IACG,CACmBpB,EAAY,KAC/BsB,GAAUA,EAAM,KAAOF,EAAQ,YAAA,EAEfP,EAAmB,CAAE,SAAAY,EAAU,QAAAL,EAAS,KAAM,GAAM,EAErEvB,EAAa,MAAM,CACjB,QAAS,uBACT,YACE,sFAAA,CACH,CACL,EAEA,OACE6B,EAAAA,KAACC,EAAA,CAAW,QAASxB,EAClB,SAAA,CAAAL,EACD8B,EAAAA,IAACC,EAAA,CACC,OAAO,oBACP,QAAS,OAAO,OAAOC,CAAc,EAAE,IAAKC,IAAa,CACvD,MAAOA,EAAQ,SAAA,EACf,MAAOC,EAAWD,EAAQ,SAAA,CAAU,CAAA,EACpC,EACF,WAAYtB,EACZ,WAAYE,EACZ,iBAAkB,EAAA,CAAA,EAEpBiB,EAAAA,IAAC,MAAA,CAAI,UAAU,oBACb,SAAAA,EAAAA,IAACK,EAAAA,SAAA,CAAS,OAAQ,GAAO,iBAAkB,IACxC,SAAA5B,EAAmB,IAAKc,GACvBS,EAAAA,IAACM,EAAAA,OAAA,CACC,SAAAN,EAAAA,IAACO,EAAA,CAAa,SAAAhB,EAAoB,WAAYK,CAAA,CAAkB,CAAA,EADrDL,EAAS,SAAS,EAE/B,CACD,CAAA,CACH,EACF,EACAS,EAAAA,IAACQ,EAAA,CACC,KAAMxB,EAAgB,KACtB,SAAUA,EAAgB,SAC1B,QAASA,EAAgB,QACzB,WAAYZ,EAAY,KACrBsB,GAAUA,EAAM,KAAOV,EAAgB,SAAS,YAAA,EAEnD,QAAS,IAAMC,EAAmB,CAAE,GAAGD,EAAiB,KAAM,GAAO,CAAA,CAAA,CACvE,EACF,CAEJ"}